<!DOCTYPE html>
<html lang="ko">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>êµìœ¡ ëŒ€ì‹œë³´ë“œ ë¡œê·¸ì¸</title>
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <style>
Â  Â  Â  Â  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
Â  Â  Â  Â  body { font-family: 'Noto Sans KR', sans-serif; }
Â  Â  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

Â  Â  <div class="w-full max-w-md bg-white p-8 rounded-xl shadow-lg">
Â  Â  Â  Â  <h1 class="text-2xl font-bold text-center mb-2">êµìœ¡ ëŒ€ì‹œë³´ë“œ</h1>
Â  Â  Â  Â  <p class="text-gray-500 text-center mb-8 text-sm">Google ê³„ì • ì—°ë™ ë¡œê·¸ì¸</p>

Â  Â  Â  Â  <form id="loginForm" class="space-y-4" onsubmit="handleLogin(event)">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-700 mb-1">ì´ë¦„ (userName)</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="inputName" required
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  placeholder="ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm font-medium text-gray-700 mb-1">ê³ ìœ ë²ˆí˜¸ (userUid)</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="password" id="inputUid" required
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  placeholder="ê³ ìœ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button type="submit" id="loginBtn"
Â  Â  Â  Â  Â  Â  Â  Â  class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition flex justify-center items-center">
Â  Â  Â  Â  Â  Â  Â  Â  ë¡œê·¸ì¸ í•˜ê¸°
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </form>

Â  Â  Â  Â  <div id="msg" class="mt-4 text-center text-sm font-medium hidden p-3 rounded-lg"></div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // â–¼â–¼â–¼â–¼â–¼â–¼ ì„¤ì • ì˜ì—­ â–¼â–¼â–¼â–¼â–¼â–¼
Â  Â  Â  Â  
Â  Â  Â  Â  // 1. ë°°í¬í•œ Google Apps Script URL (ì œê³µí•´ì£¼ì‹  í…ŒìŠ¤íŠ¸ URLë¡œ ìˆ˜ì •)
Â  Â  Â  Â  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw8AlnqUZtK5w5LvWewreq86cndgv_BdqWATsCasdA/dev";

Â  Â  Â  Â  // 2. ì´ë™í•  í˜ì´ì§€ ì´ë¦„
Â  Â  Â  Â  const TARGET_URL = "community.html";

Â  Â  Â  Â  // â–²â–²â–²â–²â–²â–² ì„¤ì • ë â–²â–²â–²â–²â–²â–²

Â  Â  Â  Â  function handleLogin(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const name = document.getElementById('inputName').value.trim();
Â  Â  Â  Â  Â  Â  const uid = document.getElementById('inputUid').value.trim();
Â  Â  Â  Â  Â  Â  const msgBox = document.getElementById('msg');
Â  Â  Â  Â  Â  Â  const btn = document.getElementById('loginBtn');

Â  Â  Â  Â  Â  Â  // 1. ë¡œë”© í‘œì‹œ
Â  Â  Â  Â  Â  Â  msgBox.classList.remove('hidden', 'bg-red-50', 'text-red-600', 'bg-green-50', 'text-green-700');
Â  Â  Â  Â  Â  Â  msgBox.className = "mt-4 text-center text-sm font-medium text-blue-600 block bg-blue-50 p-3 rounded-lg";
Â  Â  Â  Â  Â  Â  msgBox.innerHTML = `<span class="inline-block animate-spin mr-2">â†»</span>ì •ë³´ í™•ì¸ ì¤‘...`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  btn.disabled = true;
Â  Â  Â  Â  Â  Â  btn.classList.add('opacity-50', 'cursor-not-allowed');

Â  Â  Â  Â  Â  Â  // 2. Google Apps Scriptë¡œ ë°ì´í„° ì „ì†¡ (POST)
Â  Â  Â  Â  Â  Â  fetch(SCRIPT_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ userName: name, userUid: uid })
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .then(response => response.json())
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  // [ë””ë²„ê¹…] ì„œë²„ê°€ ë³´ë‚¸ ì „ì²´ ë°ì´í„°ë¥¼ ì½˜ì†”ì— ì¶œë ¥
Â  Â  Â  Â  Â  Â  Â  Â  console.log("ì„œë²„ ì‘ë‹µ ë°ì´í„°:", data);

Â  Â  Â  Â  Â  Â  Â  Â  // 3. ê²°ê³¼ ì²˜ë¦¬
                // ğŸ’¡ ìˆ˜ì •ëœ ë¶€ë¶„: GAS ì‘ë‹µ í•„ë“œë¥¼ 'result' -> 'status'ë¡œ ë³€ê²½
Â  Â  Â  Â  Â  Â  Â  Â  if (data.status === "success") { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  msgBox.className = "mt-4 text-center text-sm font-medium text-green-700 block bg-green-50 p-3 rounded-lg";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  msgBox.innerHTML = `âœ… <b>ë¡œê·¸ì¸ ì„±ê³µ!</b><br>${data.user.userName}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
                        // GASì—ì„œ ë°˜í™˜ëœ ì „ì²´ user ê°ì²´ì˜ userNameê³¼ userUidë¥¼ ì‚¬ìš©
                        const finalUrl = `${TARGET_URL}?name=${encodeURIComponent(data.user.userName)}&uid=${encodeURIComponent(data.user.userUid)}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = finalUrl;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, 1000);

Â  Â  Â  Â  Â  Â  Â  Â  } else {
                    // ğŸ’¡ ìˆ˜ì •ëœ ë¶€ë¶„: ì‹¤íŒ¨ ë©”ì‹œì§€ë¥¼ data.messageì—ì„œ ê°€ì ¸ì˜´
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const failMsg = data.message || "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."; 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(failMsg);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Login Error:", error);
Â  Â  Â  Â  Â  Â  Â  Â  msgBox.className = "mt-4 text-center text-sm font-medium text-red-600 block bg-red-50 p-3 rounded-lg";
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const errorText = error.message.replace(/\n/g, "<br>");
Â  Â  Â  Â  Â  Â  Â  Â  msgBox.innerHTML = `âš ï¸ <b>ë¡œê·¸ì¸ ì‹¤íŒ¨</b><br>${errorText}`;
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  btn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>

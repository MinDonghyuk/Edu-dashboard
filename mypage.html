<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ë‚´ ì •ë³´ ê³µìœ  í—ˆë¸Œ (ê²½ëŸ‰í™” + GAS ì—°ë™)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .main-content-section:not(.active) { display: none; }
        .main-content-section.active { display: block; }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ ìœ ì§€ */
        .db-scroll-area::-webkit-scrollbar { width: 6px; }
        .db-scroll-area::-webkit-scrollbar-thumb { background-color: #a5b4fc; border-radius: 3px; }
        .db-scroll-area::-webkit-scrollbar-track { background-color: #e5e7eb; border-radius: 3px; }
        .db-scroll-area { scrollbar-width: thin; scrollbar-color: #a5b4fc #e5e7eb; }

        #individual-history-list::-webkit-scrollbar { width: 8px; }
        #individual-history-list::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        #individual-history-list::-webkit-scrollbar-track { background-color: #f1f5f9; }
        #individual-history-list { scrollbar-width: thin; scrollbar-color: #cbd5e1 #f1f5f9; }

        .progress-bar > div { transition: width 0.5s ease-in-out; }
        
        /* ìº˜ë¦°ë” ì¼ì • í‘œì‹œ ìŠ¤íƒ€ì¼ */
        .schedule-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 2px;
        }
        .schedule-vacation { background-color: #f87171; }
        .schedule-meeting { background-color: #3b82f6; }
        .schedule-training { background-color: #10b981; }
    </style>
    <script>
        // --- ì „ì—­ ìƒìˆ˜ ë° ì´ˆê¸°í™”ëœ ë°ì´í„° ---
        const TRAINING_GOAL_HOURS = 40;
        let currentCalendarDate = new Date();
        
        // ********** GAS ì—°ë™ ì„¤ì • **********
        // Google Apps Script ë°°í¬ URL (execë¡œ ëë‚˜ëŠ”ì§€ í™•ì¸)
        const GAS_API_URL = "https://script.google.com/macros/s/AKfycbzFfTsWR4aE-uUVltWp0wgSk6_whgawDlni1hALxLGMuB-FsMDnKnDcVqtDk_j6WA66/exec";
        
        // ********** ë¡œê·¸ì¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (localStorage ì—°ë™) **********
        // Login.html ë˜ëŠ” Community ë“± ì´ì „ í˜ì´ì§€ì—ì„œ ì €ì¥í•œ ê°’ í™œìš©
        let LOGIN_USER_UID = localStorage.getItem('userUid');
        let LOGIN_USER_NAME = localStorage.getItem('userName');

        // URL íŒŒë¼ë¯¸í„° ë°±ì—… (localStorageì— ì—†ì„ ê²½ìš° ëŒ€ë¹„)
        if (!LOGIN_USER_UID) {
            const urlParams = new URLSearchParams(window.location.search);
            LOGIN_USER_UID = urlParams.get('userUid');
            // URLì—ë§Œ ìˆê³  LocalStorageì— ì—†ìœ¼ë©´ ì €ì¥í•´ë‘  (í¸ì˜ì„±)
            if (LOGIN_USER_UID) localStorage.setItem('userUid', LOGIN_USER_UID);
        }
        if (!LOGIN_USER_NAME) {
            const urlParams = new URLSearchParams(window.location.search);
            LOGIN_USER_NAME = urlParams.get('userName');
            if (LOGIN_USER_NAME) localStorage.setItem('userName', LOGIN_USER_NAME);
        }

        console.log("Current User:", LOGIN_USER_NAME, "(", LOGIN_USER_UID, ")");

        // ********** Mock Data ë° ê´€ë ¨ ë³€ìˆ˜ ëª¨ë‘ ì œê±°/ì´ˆê¸°í™” **********
        let localUserSchedules = [];
        const mockInquiryHistory = [];
        const mockTrainingHistory = [];
        const mockUpcomingTraining = [];
        let simulatedSharedPosts = [];
        const mockInterestKeywords = [];
        let localScrapedIds = [];
        
        const currentMonth = currentCalendarDate.getMonth();
        const currentYear = currentCalendarDate.getFullYear();
        const currentDay = currentCalendarDate.getDate();

        // --- ì•„ì´ì½˜ SVG ìƒì„± í•¨ìˆ˜ (ì „ì—­) ---
        function getIconSVG(name, classes) {
            const icons = {
                'User': '<path d="M19 21v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>',
                'ListChecks': '<path d="M8 6h11"></path><path d="M8 12h11"></path><path d="M8 18h11"></path><path d="M4 6.5l-1.5 1.5l-2.5 -3"></path><path d="M4 12.5l-1.5 1.5l-2.5 -3"></path><path d="M4 18.5l-1.5 1.5l-2.5 -3"></path>',
                'Target': '<circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle>',
                'ClipboardList': '<rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path>',
                'Calendar': '<rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>',
                'Check': '<polyline points="20 6 9 17 4 12"></polyline>',
                'X': '<path d="M18 6L6 18"></path><path d="M6 6l12 12"></path>',
                'Heart': '<path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"></path>',
                'Star': '<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>',
                'Pencil': '<path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>'
            };
            const svgContent = icons[name] || '';
            return `<svg xmlns="http://www.w3.org/2000/svg" class="${classes}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${svgContent}</svg>`;
        }
        
        // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
        const formatCurrency = (number) => new Intl.NumberFormat('ko-KR', {
            style: 'currency',
            currency: 'KRW',
            minimumFractionDigits: 0
        }).format(number);

        // --- ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ ---
        window.alertMessage = function(message, type = 'info') {
            const box = document.getElementById('message-box');
            let bgColor = { 'info': 'bg-blue-500', 'success': 'bg-green-500', 'error': 'bg-red-500' }[type] || 'bg-blue-500';
            
            box.textContent = message;
            box.className = `fixed bottom-4 right-4 p-4 text-white rounded-lg shadow-xl z-50 transition-transform duration-300 transform translate-x-0 ${bgColor}`;

            setTimeout(() => { box.classList.add('translate-x-full'); }, 3000);
            setTimeout(() => { box.classList.remove('translate-x-full'); }, 3500);
        }

        // --- Modal Utility Functions ---
        window.openModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('flex', 'opacity-100');
            }
        };

        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('opacity-100', 'flex');
                modal.classList.add('hidden');
            }
        };

        // --- DUMMY/MOCKUP FUNCTIONS (ëª¨ë‘ ë¹„í™œì„±í™”) ---
        window.toggleInterest = function(postId, event) {
            event.stopPropagation();
            window.alertMessage("ğŸš§ ê¸°ëŠ¥ ë¹„í™œì„±í™”: Mock ë°ì´í„° ë° ë¡œì§ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.", 'info');
            window.setupSharingListener(); 
            window.renderInterestList(); 
        };

        window.saveAnnualPlan = function(e) {
            e.preventDefault();
            window.alertMessage("ğŸš§ ê¸°ëŠ¥ ë¹„í™œì„±í™”: Mock ë°ì´í„° ë° ë¡œì§ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.", 'info');
            window.closeModal('annual-plan-modal');
        };

        window.saveUserSchedule = function(e) {
            e.preventDefault();
            window.alertMessage("ğŸš§ ê¸°ëŠ¥ ë¹„í™œì„±í™”: Mock ë°ì´í„° ë° ë¡œì§ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.", 'info');
            window.closeModal('schedule-add-modal');
        };

        window.deleteUserSchedule = function(scheduleId, event) {
            event.stopPropagation();
            window.alertMessage("ğŸš§ ê¸°ëŠ¥ ë¹„í™œì„±í™”: Mock ë°ì´í„° ë° ë¡œì§ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.", 'info');
            window.closeModal('day-detail-modal');
        }

        window.saveTrainingComment = function(e) {
            e.preventDefault();
            window.alertMessage("ğŸš§ ê¸°ëŠ¥ ë¹„í™œì„±í™”: Mock ë°ì´í„° ë° ë¡œì§ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.", 'info');
            window.closeModal('training-detail-modal');
        }

        window.sharePost = function(e) {
            e.preventDefault();
            window.alertMessage("ğŸš§ ê¸°ëŠ¥ ë¹„í™œì„±í™”: Mock ë°ì´í„° ë° ë¡œì§ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.", 'info');
        }

        // --- ë Œë”ë§ ë¡œì§ (ë°ì´í„° ì œê±° ë° ì´ˆê¸°í™”) ---
        function renderAchievementSummary() {
            let totalHours = 0; 
            let totalCost = 0; 
            let totalNetCost = 0; 
            
            const achievementRate = (totalHours / TRAINING_GOAL_HOURS) * 100;
            const safeRate = Math.max(0, Math.min(100, achievementRate));
            const rateText = `${totalHours.toFixed(1)}ì‹œê°„ / ${TRAINING_GOAL_HOURS}ì‹œê°„ (${safeRate.toFixed(1)}%)`;
            const totalCostText = formatCurrency(totalCost);
            const totalNetCostText = formatCurrency(totalNetCost);

            const html = `
                <div class="grid grid-cols-1 gap-4 mb-4">
                    <div class="col-span-1">
                        <p class="text-md font-bold text-indigo-700 mb-2">ì´ ë‹¬ì„±ìœ¨: ${rateText}</p>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-indigo-600 h-2.5 rounded-full transition-all duration-500" style="width: ${safeRate}%;"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="col-span-1">
                            <strong class="block text-xs font-semibold text-gray-500">ì´ êµìœ¡ ë¹„ìš©:</strong>
                            <span class="font-bold text-teal-600">${totalCostText}</span>
                        </div>
                        <div class="col-span-1">
                            <strong class="block text-xs font-semibold text-gray-500">ìˆœìˆ˜ ë¶€ë‹´ ë¹„ìš©:</strong>
                            <span class="font-bold text-red-600">${totalNetCostText}</span>
                        </div>
                    </div>
                    <div class="bg-red-100 p-2 text-sm text-red-700 rounded-md">âš ï¸ ì´ ì„¹ì…˜ì˜ ë°ì´í„°ëŠ” ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
                </div>
            `;
            return `<div class="p-4 border border-indigo-200 bg-indigo-50 rounded-lg h-full">${html}</div>`;
        }

        window.fetchAndRenderAnnualPlan = function() {
            const planContainer = document.getElementById('annual-plan-display');
            if (!planContainer) return;

            const writeButton = `
                <button onclick="openModal('annual-plan-modal')" class="px-3 py-1 text-sm font-semibold rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition duration-150 shadow-md flex items-center" disabled>
                    ${getIconSVG('Pencil', 'w-4 h-4 mr-1')} 
                    ê³„íš ì‘ì„±í•˜ê¸° (ë¹„í™œì„±í™”)
                </button>
            `;
            
            planContainer.innerHTML = `
                <div class="p-4 bg-white border border-indigo-300 rounded-xl shadow-inner space-y-2 h-full flex flex-col justify-between">
                    <div>
                        <p class="text-xs font-semibold text-gray-500">ë‚˜ì˜ ê¸ˆë…„ë„ êµìœ¡ ê³„íš</p>
                        <div class="flex justify-between items-start">
                            <p class="text-lg font-bold text-gray-500 truncate pr-4">ë°ì´í„° ë¡œë“œ ë¶ˆê°€</p>
                            <span class="text-xs font-semibold px-3 py-1 rounded-full bg-gray-500 text-white flex-shrink-0">ë¹„í™œì„±í™”</span>
                        </div>
                        <p class="text-sm text-gray-600 whitespace-pre-wrap max-h-16 overflow-hidden border-l-2 pl-2 border-gray-200">ë°ì´í„° ì—°ë™ ë¡œì§ì´ ì œê±°ë˜ì–´ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ê³„íšì„ ì‘ì„±í•´ë„ ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                    </div>
                    <div class="flex justify-between items-center pt-2 border-t border-gray-100 text-xs text-gray-500">
                        <span>ì‘ì„±ì¼: -</span>
                        ${writeButton}
                    </div>
                </div>
            `;
        }

        window.applyTrainingFilters = function() {
            const typeFilter = document.getElementById('type-filter')?.value || 'All';
            const refundFilter = document.getElementById('refund-filter')?.value || 'All';
            window.fetchTrainingData(typeFilter, refundFilter);
        }

        window.fetchTrainingData = function(typeFilter = 'All', refundFilter = 'All') {
            const individualHistoryList = document.getElementById('individual-history-list');
            if(individualHistoryList) individualHistoryList.innerHTML = `<p class="text-gray-500 p-4 font-semibold">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì´ìˆ˜ ë‚´ì—­ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }

        function renderInquiryHistory() {
            const container = document.getElementById('inquiry-history-list');
            if (!container) return;
            container.innerHTML = `<p class="text-center text-gray-500 p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì´ë ¥ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }

        function renderKeywordList() {
            const container = document.getElementById('keyword-list-container');
            if (!container) return;
            container.innerHTML = `<p class="text-center text-gray-500 col-span-full p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ í‚¤ì›Œë“œ ëª©ë¡ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }
        
        window.openTrainingDetailModal = function(itemId) {
            const modal = document.getElementById('training-detail-modal');
            const item = { course: 'ë°ì´í„° ë¡œë“œ ë¶ˆê°€', host: 'N/A', type: 'N/A', period: 'N/A', hours: 0, cost: 0, refund: 'N/A' };
            
            document.getElementById('detail-course-name').textContent = item.course;
            document.getElementById('detail-item-id').value = itemId;

            document.getElementById('detail-content-body').innerHTML = `
                <div class="space-y-2 text-sm text-gray-700">
                    <div class="flex justify-between border-b pb-1"><span class="font-semibold text-gray-500">ì£¼ê´€/í˜•íƒœ:</span><span>${item.host} (${item.type})</span></div>
                    <div class="flex justify-between border-b pb-1"><span class="font-semibold text-gray-500">ì´ìˆ˜ ê¸°ê°„:</span><span>${item.period}</span></div>
                    <div class="flex justify-between border-b pb-1"><span class="font-semibold text-gray-500">ì¸ì • ì‹œê°„:</span><span class="font-bold text-indigo-600">${item.hours.toFixed(1)}h</span></div>
                    <div class="flex justify-between border-b pb-1"><span class="font-semibold text-gray-500">ì´ ë¹„ìš© / í™˜ê¸‰ ì—¬ë¶€:</span><span class="font-bold text-gray-500">${formatCurrency(item.cost)} (${item.refund})</span></div>
                </div>
                <div class="mt-4 p-3 bg-red-100 rounded-lg">
                    <p class="text-red-500 font-bold mb-1">âš ï¸ ë°ì´í„° ì €ì¥/ë¡œë“œ ê¸°ëŠ¥ì€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                </div>
            `;
            document.getElementById('detail-user-comment').value = '';
            document.getElementById('detail-attachment').value = '';
            document.getElementById('detail-user-comment').disabled = true;
            document.getElementById('detail-attachment').disabled = true;
            document.getElementById('comment-save-btn').disabled = true;

            openModal('training-detail-modal');
        }

        function renderUpcomingTrainingList() {
            const upcomingListContainer = document.getElementById('upcoming-list-container');
            if (!upcomingListContainer) return;
            upcomingListContainer.innerHTML = `<p class="text-gray-500 p-2 font-semibold">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì¼ì •ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }

        function renderCalendar() {
            const calendarContainer = document.getElementById('calendar-container');
            if (!calendarContainer) return;

            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const schedulesInMonth = {};
            
            function getDayColor(dayIndex) {
                if (dayIndex === 0) return 'text-red-500'; 
                if (dayIndex === 6) return 'text-blue-500'; 
                return 'text-gray-700';
            }
            
            let html = `
                <div class="flex justify-between items-center mb-2">
                    <button onclick="changeMonth(-1)" class="p-2 rounded-full hover:bg-gray-100 text-gray-700" aria-label="ì´ì „ ë‹¬">${getIconSVG('X', 'w-5 h-5 transform rotate-45')}</button>
                    <h5 class="text-xl font-bold text-indigo-700">${year}ë…„ ${month + 1}ì›”</h5>
                    <button onclick="changeMonth(1)" class="p-2 rounded-full hover:bg-gray-100 text-gray-700" aria-label="ë‹¤ìŒ ë‹¬">${getIconSVG('X', 'w-5 h-5 transform -rotate-45')}</button>
                </div>
                <div class="flex-grow flex flex-col justify-between">
                    <table class="w-full text-center border-collapse rounded-lg overflow-hidden flex-grow">
                        <thead>
                            <tr class="text-xs font-semibold text-gray-500 bg-gray-100">
                                <th class="py-1 ${getDayColor(0)}">ì¼</th>
                                <th class="py-1 ${getDayColor(1)}">ì›”</th>
                                <th class="py-1 ${getDayColor(2)}">í™”</th>
                                <th class="py-1 ${getDayColor(3)}">ìˆ˜</th>
                                <th class="py-1 ${getDayColor(4)}">ëª©</th>
                                <th class="py-1 ${getDayColor(5)}">ê¸ˆ</th>
                                <th class="py-1 ${getDayColor(6)}">í† </th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            let day = 1;
            let todayDate = new Date();
            todayDate.setHours(0, 0, 0, 0);

            for (let i = 0; i < 6; i++) {
                html += '<tr>';
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < firstDayOfMonth || day > daysInMonth) {
                        html += '<td class="p-0.5 border border-gray-100 bg-gray-50"></td>';
                    } else {
                        const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                        const isToday = new Date(dateKey + 'T00:00:00').getTime() === todayDate.getTime();
                        
                        let dayClasses = `p-0.5 border border-gray-100 text-sm font-medium h-8 align-top cursor-pointer transition duration-150 hover:bg-indigo-50`;
                        if (isToday) {
                            dayClasses += ' bg-amber-100 border-2 border-amber-500 rounded-lg shadow-inner';
                        }
                        
                        const schedulesOnDay = schedulesInMonth[dateKey] || [];
                        let scheduleDots = '';
                        
                        html += `<td class="${dayClasses}" onclick="openDayDetailModal('${dateKey}')">`;
                        html += `<span class="${getDayColor(j)} block text-xs">${day}</span>`;
                        if (scheduleDots) {
                            html += `<div class="mt-0.5 flex justify-center flex-wrap">${scheduleDots}</div>`;
                        }
                        html += `</td>`;
                        day++;
                    }
                }
                html += '</tr>';
                if (day > daysInMonth) break;
            }

            html += `</tbody></table></div>`;
            calendarContainer.innerHTML = html;
        }

        window.changeMonth = function(offset) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + offset);
            renderCalendar();
            renderUpcomingTrainingList(); 
        }

        window.openDayDetailModal = function(dateKey) {
            const detailModal = document.getElementById('day-detail-modal');
            if (!detailModal) return;

            const dateTitle = document.getElementById('day-detail-date');
            const listContainer = document.getElementById('day-event-list');
            const targetDate = new Date(dateKey + 'T00:00:00');

            if (dateTitle) dateTitle.textContent = `${targetDate.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'short' })} ì¼ì •`;
            listContainer.innerHTML = `<p class="text-center text-gray-500 p-4">ë“±ë¡ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤. (ë°ì´í„° ë¡œì§ ì œê±°ë¨)</p>`;
            
            const scheduleDateInput = document.getElementById('schedule-date');
            if (scheduleDateInput) {
                scheduleDateInput.value = dateKey;
            }
            openModal('day-detail-modal');
        }
        
        window.renderInterestList = function() {
            const listContainer = document.getElementById('interest-list-container');
            if (!listContainer) return;
            listContainer.innerHTML = `<p class="text-center text-gray-500 p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ëª©ë¡ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }

        window.setupSharingListener = function() {
            const sharedList = document.getElementById('shared-list');
            if(!sharedList) return;
            sharedList.innerHTML = `<p class="text-center text-gray-500 p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ê²Œì‹œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;
        }
        
        // ********** NEW: GAS í”„ë¡œí•„ ë°ì´í„° ì—°ë™ í•¨ìˆ˜ **********
        async function fetchUserProfile() {
            const statusMsg = document.getElementById('profile-status-msg');
            
            // 1. [ì¦‰ì‹œ ì‹¤í–‰] LocalStorageì— ìˆëŠ” ì •ë³´ë¡œ ìš°ì„  í™”ë©´ ì±„ìš°ê¸°
            if (LOGIN_USER_UID && document.getElementById('profile-uid')) {
                document.getElementById('profile-uid').textContent = LOGIN_USER_UID;
            }
            if (LOGIN_USER_NAME && document.getElementById('profile-name')) {
                document.getElementById('profile-name').textContent = LOGIN_USER_NAME;
            }

            // 2. ë¡œê·¸ì¸ ì •ë³´ê°€ ì•„ì˜ˆ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬
            if (!LOGIN_USER_UID) {
                if(statusMsg) {
                    statusMsg.className = "col-span-2 text-xs text-red-500 pt-2 border-t border-red-200";
                    statusMsg.textContent = "âš ï¸ ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.";
                }
                return; // í•¨ìˆ˜ ì¢…ë£Œ
            }

            try {
                // 3. GASì— ì‚¬ë²ˆ(userUid)ì„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ì—¬ ë‚˜ë¨¸ì§€ ì •ë³´ ìš”ì²­
                const response = await fetch(`${GAS_API_URL}?userUid=${LOGIN_USER_UID}`);
                
                if (!response.ok) {
                    throw new Error('ë„¤íŠ¸ì›Œí¬ ì‘ë‹µì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.');
                }

                const jsonResponse = await response.json();

                // GASì—ì„œ ë³´ë‚´ì¤€ ë°ì´í„° êµ¬ì¡°ê°€ { result: "success", data: { ... } } ë¼ê³  ê°€ì •
                if (jsonResponse.result === 'success' && jsonResponse.data) {
                    const userData = jsonResponse.data;

                    // ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ HTML IDì— ë§¤ì¹­í•˜ì—¬ ë„£ê¸°
                    // userNameì€ GAS ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë®ì–´ì“°ê³ , ì—†ìœ¼ë©´ ê¸°ì¡´ localStorage ê°’ ìœ ì§€
                    if(document.getElementById('profile-name')) document.getElementById('profile-name').textContent = userData.userName || LOGIN_USER_NAME || '-';
                    if(document.getElementById('profile-uid')) document.getElementById('profile-uid').textContent = userData.userUid || LOGIN_USER_UID || '-';
                    if(document.getElementById('profile-dept')) document.getElementById('profile-dept').textContent = userData.deptName || '-';
                    if(document.getElementById('profile-grade')) document.getElementById('profile-grade').textContent = userData.gradeName || '-';
                    if(document.getElementById('profile-email')) document.getElementById('profile-email').textContent = userData.sysmail || '-';

                    // ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
                    if(statusMsg) {
                        statusMsg.className = "col-span-2 text-xs text-green-600 pt-2 border-t border-green-200";
                        statusMsg.textContent = "âœ… ìµœì‹  ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.";
                    }
                } else {
                    // ì‚¬ë²ˆì„ ì°¾ì§€ ëª»í•œ ê²½ìš°
                    if(statusMsg) {
                        statusMsg.className = "col-span-2 text-xs text-red-500 pt-2 border-t border-red-200";
                        statusMsg.textContent = "âš ï¸ í•´ë‹¹ ì‚¬ë²ˆì˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                    }
                }

            } catch (error) {
                console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", error);
                if(statusMsg) {
                    statusMsg.className = "col-span-2 text-xs text-red-500 pt-2 border-t border-red-200";
                    statusMsg.textContent = "âš ï¸ ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (CORS ë˜ëŠ” URL í™•ì¸ í•„ìš”)";
                }
            }
        }

        function startDataListeners() {
            window.fetchAndRenderAnnualPlan(); 
            renderCalendar();
            renderUpcomingTrainingList(); 
            // ********** í”„ë¡œí•„ ë°ì´í„° í˜¸ì¶œ **********
            fetchUserProfile();
        }

        // --- íƒ­ ì „í™˜ í•¨ìˆ˜ ---
        window.switchMainContent = function(contentId) {
            document.querySelectorAll('#sidebar-nav button').forEach(btn => {
                btn.classList.remove('bg-indigo-100', 'text-indigo-700', 'font-bold');
                btn.classList.add('text-gray-700', 'hover:bg-gray-50');
            });

            const activeBtn = document.querySelector(`#sidebar-nav button[data-content="${contentId}"]`);
            if (activeBtn) {
                activeBtn.classList.remove('text-gray-700', 'hover:bg-gray-50');
                activeBtn.classList.add('bg-indigo-100', 'text-indigo-700', 'font-bold');
            }

            document.querySelectorAll('.main-content-section').forEach(section => {
                section.classList.remove('active');
            });

            const activeSection = document.getElementById(contentId);
            if (activeSection) {
                activeSection.classList.add('active');
            }
            
            if (contentId === 'personal-info-section') {
                document.getElementById('achievement-summary-display').innerHTML = renderAchievementSummary();
                window.fetchAndRenderAnnualPlan();
                renderCalendar();
                renderUpcomingTrainingList();
            }
            if (contentId === 'individual-history-section') {
                window.applyTrainingFilters(); 
            }
            if (contentId === 'interest-list-section') { 
                window.renderInterestList(); 
                document.getElementById('team-status-display').innerHTML = `<p class="text-gray-700 p-2 font-semibold">íŒ€ êµìœ¡ í˜„í™© ë°ì´í„°ëŠ” í˜„ì¬ ë¹„í™œì„±í™”ë˜ì–´ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>`;
            }
            if (contentId === 'sharing-board-section') {
                window.setupSharingListener(); 
            }
            if (contentId === 'inquiry-section') {
                renderInquiryHistory();
            }
        }
        
        // --- ì´ˆê¸°í™” ë° ì‹œì‘ ---
        window.onload = () => {
            document.getElementById('loading-indicator').classList.add('hidden');
            startDataListeners();
            window.switchMainContent('personal-info-section'); 
            
            const sharingForm = document.getElementById('sharing-form');
            if(sharingForm) {
                sharingForm.addEventListener('submit', window.sharePost);
            }
        }
    </script>

    <!-- Global Message Box -->
    <div id="message-box" class="fixed bottom-4 right-4 p-4 text-white rounded-lg shadow-xl z-50 transition-transform transform translate-x-full bg-blue-500"></div>

    <!-- ê¸ˆë…„ë„ êµìœ¡ê³„íš ì‘ì„± ëª¨ë‹¬ -->
    <div id="annual-plan-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-70 items-center justify-center p-4 z-50 transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto transform transition-transform duration-300 scale-100" onclick="event.stopPropagation()">
            <form onsubmit="window.saveAnnualPlan(event)" class="p-6 bg-white rounded-xl space-y-4">
                <div class="flex justify-between items-center border-b pb-3 mb-4">
                    <h3 class="text-2xl font-bold text-indigo-700">ê¸ˆë…„ë„ êµìœ¡ê³„íš ì‘ì„±</h3>
                    <button type="button" onclick="closeModal('annual-plan-modal')" class="p-2 text-gray-500 hover:text-gray-900 rounded-full hover:bg-gray-100 transition duration-150" aria-label="ë‹«ê¸°">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18"></path><path d="M6 6l12 12"></path></svg>
                    </button>
                </div>
                <div class="bg-red-50 border-l-4 border-red-400 text-red-700 p-3 text-sm" role="alert">
                    <p class="font-semibold">âš ï¸ ê¸°ëŠ¥ ë¹„í™œì„±í™”</p>
                    <p>ì´ ì–‘ì‹ì€ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                </div>
                <div>
                    <label for="plan-title" class="block text-sm font-medium text-gray-700 mb-1">ê³„íš ì œëª©</label>
                    <input id="plan-title" type="text" name="plan-title" placeholder="ì˜ˆ: 2026ë…„ í´ë¼ìš°ë“œ ì—”ì§€ë‹ˆì–´ë§ ì—­ëŸ‰ ê°•í™”" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" required disabled>
                </div>
                <div>
                    <label for="course-details" class="block text-sm font-medium text-gray-700 mb-1">ì„¸ë¶€ êµìœ¡ ê³¼ì • ë° ëª©í‘œ (íŒ€ì¥ ìŠ¹ì¸ìš©)</label>
                    <textarea id="course-details" rows="8" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" required disabled></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeModal('annual-plan-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition duration-150 font-semibold">ì·¨ì†Œ</button>
                    <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition duration-150 shadow-md flex items-center" disabled>
                        ${getIconSVG('Check', 'w-4 h-4 mr-1')} ìŠ¹ì¸ ìš”ì²­ (ë¹„í™œì„±í™”)
                    </button>
                </div>
            </form>
            <script>document.getElementById('annual-plan-modal').addEventListener('click', (e) => { if(e.target.id === 'annual-plan-modal') closeModal('annual-plan-modal'); });</script>
        </div>
    </div>

    <!-- ê°œì¸ ì¼ì • ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="schedule-add-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-70 items-center justify-center p-4 z-50 transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm transform transition-transform duration-300 scale-100" onclick="event.stopPropagation()">
            <form onsubmit="window.saveUserSchedule(event)" class="p-6 bg-white rounded-xl space-y-4">
                <div class="flex justify-between items-center border-b pb-3 mb-4">
                    <h3 class="text-xl font-bold text-teal-700">ê°œì¸ ì¼ì • ì¶”ê°€</h3>
                    <button type="button" onclick="closeModal('schedule-add-modal')" class="p-2 text-gray-500 hover:text-gray-900 rounded-full hover:bg-gray-100 transition duration-150" aria-label="ë‹«ê¸°">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18"></path><path d="M6 6l12 12"></path></svg>
                    </button>
                </div>
                <div class="bg-red-50 border-l-4 border-red-400 text-red-700 p-3 text-sm" role="alert">
                    <p class="font-semibold">âš ï¸ ê¸°ëŠ¥ ë¹„í™œì„±í™”</p>
                    <p>ì´ ì–‘ì‹ì€ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                </div>
                <div>
                    <label for="schedule-title" class="block text-sm font-medium text-gray-700 mb-1">ì¼ì • ì œëª©</label>
                    <input id="schedule-title" type="text" name="schedule-title" placeholder="ì˜ˆ: íŒ€ íšŒì‹" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500" required disabled>
                </div>
                <div>
                    <label for="schedule-date" class="block text-sm font-medium text-gray-700 mb-1">ë‚ ì§œ</label>
                    <input id="schedule-date" type="date" name="schedule-date" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500" required disabled>
                </div>
                <div>
                    <label for="schedule-type" class="block text-sm font-medium text-gray-700 mb-1">ì¼ì • ìœ í˜•</label>
                    <select id="schedule-type" name="schedule-type" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500" required disabled>
                        <option value="meeting">íšŒì˜/í–‰ì‚¬ (íŒŒë‘)</option>
                        <option value="training">êµìœ¡/ì›Œí¬ìˆ (ì´ˆë¡)</option>
                        <option value="vacation">íœ´ê°€/ìë¦¬ë¹„ì›€ (ë¹¨ê°•)</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-3 pt-2">
                    <button type="submit" class="px-4 py-2 bg-teal-600 text-white rounded-lg font-bold hover:bg-teal-700 transition duration-150 shadow-md flex items-center" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg> ì €ì¥ (ë¹„í™œì„±í™”)
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì¼ë³„ ìƒì„¸ ì¼ì • ëª¨ë‹¬ -->
    <div id="day-detail-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-70 items-center justify-center p-4 z-50 transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto transform transition-transform duration-300 scale-100" onclick="event.stopPropagation()">
            <div class="p-6 bg-white rounded-xl space-y-4">
                <div class="flex justify-between items-center border-b pb-3 mb-4">
                    <h3 id="day-detail-date" class="text-xl font-bold text-indigo-700">ìƒì„¸ ì¼ì •</h3>
                    <button type="button" onclick="closeModal('day-detail-modal')" class="p-2 text-gray-500 hover:text-gray-900 rounded-full hover:bg-gray-100 transition duration-150" aria-label="ë‹«ê¸°">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18"></path><path d="M6 6l12 12"></path></svg>
                    </button>
                </div>
                <ul id="day-event-list" class="space-y-3">
                    <p class="text-center text-gray-500 p-4">ë“±ë¡ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤. (ë°ì´í„° ë¡œì§ ì œê±°ë¨)</p>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- êµìœ¡ ìƒì„¸ ë° ê°œì¸ ë©”ëª¨ ëª¨ë‹¬ -->
    <div id="training-detail-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-70 items-center justify-center p-4 z-50 transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-xl max-h-[90vh] overflow-y-auto transform transition-transform duration-300 scale-100" onclick="event.stopPropagation()">
            <form onsubmit="window.saveTrainingComment(event)" class="p-6 bg-white rounded-xl space-y-4">
                <input type="hidden" id="detail-item-id" value="">
                <div class="flex justify-between items-center border-b pb-3 mb-4">
                    <h3 class="text-2xl font-bold text-indigo-700" id="detail-course-name">êµìœ¡ ìƒì„¸ ì •ë³´</h3>
                    <button type="button" onclick="closeModal('training-detail-modal')" class="p-2 text-gray-500 hover:text-gray-900 rounded-full hover:bg-gray-100 transition duration-150" aria-label="ë‹«ê¸°">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18"></path><path d="M6 6l12 12"></path></svg>
                    </button>
                </div>
                
                <div id="detail-content-body" class="mb-6 p-4 border border-gray-200 rounded-lg">
                    <p class="text-red-500 font-bold">ë°ì´í„° ì—°ë™ ë¹„í™œì„±í™”ë¡œ êµìœ¡ ìƒì„¸ ì •ë³´ê°€ ë¡œë“œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                </div>

                <div class="pt-4 border-t border-gray-100">
                    <label for="detail-user-comment" class="block text-lg font-semibold text-gray-700 mb-2">ë‚˜ì˜ ê°œì¸ ë©”ëª¨ / í›„ê¸°</label>
                    <textarea id="detail-user-comment" rows="4" placeholder="êµìœ¡ ì´ìˆ˜ ì†Œê°, ì ìš© ê³„íš, ê°œì¸ì ì¸ ì½”ë©˜íŠ¸ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”. (ì €ì¥ ê¸°ëŠ¥ ë¹„í™œì„±í™”)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500" disabled></textarea>
                    
                    <div class="mt-4">
                        <label for="detail-attachment" class="block text-sm font-semibold text-gray-700 mb-1">ì²¨ë¶€ íŒŒì¼ ì„ íƒ (íŒŒì¼ëª…ë§Œ ì €ì¥ë¨)</label>
                        <input type="file" id="detail-attachment" name="detail-attachment" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" disabled/>
                    </div>

                    <div class="flex justify-end pt-4">
                        <button type="submit" id="comment-save-btn" class="px-4 py-2 bg-teal-600 text-white rounded-lg font-bold hover:bg-teal-700 transition duration-150 shadow-md flex items-center" disabled>
                            ${getIconSVG('Check', 'w-4 h-4 mr-1')} ë©”ëª¨ ì €ì¥ (ë¹„í™œì„±í™”)
                        </button>
                    </div>
                </div>
                
            </form>
        </div>
    </div>


    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-8">
        
        <!-- Column 1 (lg:col-span-1): ì‚¬ì´ë“œë°”/ë„¤ë¹„ê²Œì´ì…˜ -->
        <aside class="lg:col-span-1 space-y-6">
            <header class="p-4 bg-white rounded-xl shadow-lg border-t-4 border-indigo-500">
                <h1 class="text-2xl font-extrabold text-indigo-700">ë§ˆì´ í˜ì´ì§€</h1>
                <div id="loading-indicator" class="mt-2 text-indigo-500 font-semibold flex items-center hidden">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    ë°ì´í„° ë¡œë“œ ì¤‘...
                </div>
            </header>

            <!-- ê°œì¸ í”„ë¡œí•„ -->
            <div class="bg-white p-4 rounded-xl shadow-lg border-t-4 border-teal-500">
                <h3 class="text-lg font-bold text-teal-700 mb-3 border-b pb-2 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                    ê°œì¸ í”„ë¡œí•„
                </h3>
                <!-- ********** ìˆ˜ì •: ID ë¶€ì—¬ëœ í”„ë¡œí•„ ì„¹ì…˜ ********** -->
                <div id="personal-info-display" class="p-5 border border-teal-200 bg-teal-50 rounded-lg space-y-1 text-sm">
                    <div class="grid grid-cols-2 gap-y-5 gap-x-4 text-sm">
                        <div class="col-span-1 flex flex-col">
                            <strong class="text-xs font-semibold text-gray-500">ì´ë¦„:</strong>
                            <span id="profile-name" class="font-semibold text-gray-800">-</span>
                        </div>
                        <div class="col-span-1 flex flex-col">
                            <strong class="text-xs font-semibold text-gray-500">ì‚¬ë²ˆ:</strong>
                            <span id="profile-uid" class="text-gray-800">-</span>
                        </div>
                        <div class="col-span-2 flex flex-col">
                            <strong class="text-xs font-semibold text-gray-500">ë¶€ì„œ:</strong>
                            <span id="profile-dept" class="text-gray-800">-</span>
                        </div>
                        <div class="col-span-1 flex flex-col">
                            <strong class="text-xs font-semibold text-gray-500">ì§ì±…:</strong>
                            <span id="profile-grade" class="text-gray-800">-</span>
                        </div>
                        <div class="col-span-1 flex flex-col">
                            <strong class="text-xs font-semibold text-gray-500">ì´ë©”ì¼:</strong>
                            <span id="profile-email" class="text-gray-800 break-all">-</span>
                        </div>
                    </div>
                    <p id="profile-status-msg" class="col-span-2 text-xs text-indigo-500 pt-2 border-t border-indigo-200 animate-pulse">
                        ğŸ”„ êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                    </p>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <nav id="sidebar-nav" class="bg-white p-2 rounded-xl shadow-lg space-y-1 h-80">
                <h3 class="text-sm font-semibold text-gray-500 px-3 pt-2 pb-1">ë©”ì¸ ë©”ë‰´</h3>
                <button 
                    data-content="personal-info-section" 
                    onclick="switchMainContent('personal-info-section')" 
                    class="w-full text-left flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-50 transition duration-150 active bg-indigo-100 text-indigo-700 font-bold"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg> ê¸ˆë…„ë„ êµìœ¡ í˜„í™©
                </button>
                <button 
                    data-content="individual-history-section" 
                    onclick="switchMainContent('individual-history-section')" 
                    class="w-full text-left flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-50 transition duration-150"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 6h11"></path><path d="M8 12h11"></path><path d="M8 18h11"></path><path d="M4 6.5l-1.5 1.5l-2.5 -3"></path><path d="M4 12.5l-1.5 1.5l-2.5 -3"></path><path d="M4 18.5l-1.5 1.5l-2.5 -3"></path></svg> êµìœ¡ ì´ìˆ˜ ì´ë ¥
                </button>
                <button 
                    data-content="interest-list-section" 
                    onclick="switchMainContent('interest-list-section')" 
                    class="w-full text-left flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-50 transition duration-150"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg> ì €ì¥ ëª©ë¡
                </button>
                <button 
                    data-content="sharing-board-section" 
                    onclick="switchMainContent('sharing-board-section')" 
                    class="w-full text-left flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-50 transition duration-150"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M11 4a9 9 0 0 1 9 9"></path><path d="M21 21l-7.38-7.38"></path></svg> êµìœ¡ ê³µìœ  ê²Œì‹œíŒ
                </button>
                <button 
                    data-content="inquiry-section" 
                    onclick="switchMainContent('inquiry-section')" 
                    class="w-full text-left flex items-center p-3 rounded-lg text-gray-700 hover:bg-gray-50 transition duration-150"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg> ë¬¸ì˜/ì‘ì„± ì´ë ¥
                </button>
            </nav>
        </aside>

        <!-- Column 2 (lg:col-span-3): ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
        <main class="lg:col-span-3 space-y-8">

            <!-- 0. [ê³ ì • ì„¹ì…˜] ëŒ€ì‹œë³´ë“œ: ì¼ì • ë° ìº˜ë¦°ë” (ë©”ë‰´ ì „í™˜ê³¼ ë¬´ê´€í•˜ê²Œ í•­ìƒ í‘œì‹œ) -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-indigo-500 h-[420px] flex flex-col">
                <h2 class="text-2xl font-bold text-gray-700 mb-4">ëŒ€ì‹œë³´ë“œ: ì¼ì • ë° ìº˜ë¦°ë”</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 flex-grow overflow-hidden">
                    <!-- Upcoming List (1/3) -->
                    <div class="lg:col-span-1 bg-gray-50 p-3 rounded-xl border border-indigo-200 shadow-md h-full flex flex-col">
                        <h4 class="text-lg font-bold text-indigo-700 mb-3 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg> 
                            ë‹¤ê°€ì˜¤ëŠ” ì¼ì •
                        </h4>
                        <div id="upcoming-list-container" class="space-y-3 db-scroll-area overflow-y-auto flex-grow pr-1">
                            <p class="text-gray-500 text-sm">ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì¼ì •ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                        </div>
                    </div>
                    <!-- Calendar (2/3) -->
                    <div class="lg:col-span-2 bg-white p-2 rounded-xl h-full flex flex-col">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-lg font-bold text-indigo-700">ì›”ê°„ ìº˜ë¦°ë”</h4>
                            <button onclick="openModal('schedule-add-modal')" class="px-3 py-1 text-sm font-semibold rounded-lg bg-teal-600 text-white hover:bg-teal-700 transition duration-150 shadow-md flex items-center" disabled>
                                + ì¼ì • ì¶”ê°€
                            </button>
                        </div>
                        <div id="calendar-container" class="select-none flex-grow overflow-hidden">
                            <p class="text-center text-gray-500 p-8">ìº˜ë¦°ë” ë¡œë“œ ì¤‘...</p>
                        </div>
                        <div class="flex space-x-4 justify-end text-xs text-gray-600 pt-2 border-t mt-auto">
                            <span class="flex items-center"><span class="schedule-dot schedule-meeting mr-1"></span>íšŒì˜</span>
                            <span class="flex items-center"><span class="schedule-dot schedule-training mr-1"></span>êµìœ¡</span>
                            <span class="flex items-center"><span class="schedule-dot schedule-vacation mr-1"></span>íœ´ê°€</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 1. [ê°€ë³€ ì„¹ì…˜] ê¸ˆë…„ë„ êµìœ¡ ê³„íš ë° ë‹¬ì„±ë¥  (ë©”ë‰´ 'ê¸ˆë…„ë„ êµìœ¡ í˜„í™©' ì„ íƒ ì‹œ í‘œì‹œ) -->
            <div id="personal-info-section" class="main-content-section active space-y-8">
                
                <!-- [í•˜ë‹¨ ì¹´ë“œ] êµìœ¡ ê³„íš ë° ë‹¬ì„±ë¥  -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-indigo-500">
                    <div class="flex flex-col md:flex-row md:space-x-8 space-y-6 md:space-y-0 h-full">
                        
                        <!-- êµìœ¡ ê³„íš (2/3) -->
                        <div class="w-full md:w-2/3 flex flex-col"> 
                            <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2 flex items-center justify-between">
                                <span>ê¸ˆë…„ë„ êµìœ¡ ê³„íš</span>
                                <span class="text-xs font-normal text-gray-500">2025ë…„ë„ ëª©í‘œ</span>
                            </h3>
                            <div id="annual-plan-display" class="flex-grow">
                                <div class="p-4 bg-gray-50 border border-indigo-200 rounded-xl space-y-2 h-full flex flex-col justify-between">
                                    <div>
                                        <div class="flex justify-between items-start mb-2">
                                            <p class="text-lg font-bold text-gray-600">ë°ì´í„° ë¡œë“œ ë¶ˆê°€</p>
                                            <span class="text-xs font-semibold px-2 py-1 rounded bg-gray-400 text-white">Inactive</span>
                                        </div>
                                        <p class="text-sm text-gray-600">ë°ì´í„° ì—°ë™ ë¡œì§ì´ ì œê±°ë˜ì–´ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                                    </div>
                                    <div class="flex justify-end pt-2 border-t border-gray-200">
                                        <button onclick="openModal('annual-plan-modal')" class="px-3 py-1 text-sm font-semibold rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition duration-150 shadow-md flex items-center" disabled>
                                            ${getIconSVG('Pencil', 'w-4 h-4 mr-1')} ê³„íš ì‘ì„±
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ë‹¬ì„±ë¥  ìš”ì•½ (1/3) -->
                        <div class="w-full md:w-1/3 flex flex-col"> 
                            <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">êµìœ¡ ë‹¬ì„±ë¥  ìš”ì•½</h3>
                            <div id="achievement-summary-display" class="p-4 border border-indigo-200 bg-indigo-50 rounded-lg flex-grow flex items-center justify-center">
                                <p class="text-gray-500">ë°ì´í„° ë¡œë“œ ì¤‘...</p>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

            <!-- 2. êµìœ¡ ì´ìˆ˜ ì´ë ¥ ì„¹ì…˜ -->
            <div id="individual-history-section" class="main-content-section">
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-indigo-600 min-h-[400px]">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-700">êµìœ¡ ì´ìˆ˜ ì´ë ¥</h2>
                    </div>
                    
                    <div class="flex space-x-4 mb-4 items-center">
                        <h3 class="text-lg font-semibold text-gray-600">ìƒì„¸ ì´ë ¥ ëª©ë¡</h3>
                        <select id="type-filter" onchange="applyTrainingFilters()" class="p-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500" disabled>
                            <option value="All">í˜•íƒœ ì „ì²´</option>
                            <option value="ì˜¨ë¼ì¸">ì˜¨ë¼ì¸</option>
                            <option value="ì‚¬ì™¸ê°•ì˜">ì‚¬ì™¸ê°•ì˜</option>
                            <option value="ì‚¬ë‚´ê°•ì˜">ì‚¬ë‚´ê°•ì˜</option>
                            <option value="ì›Œí¬ìˆ">ì›Œí¬ìˆ</option>
                        </select>
                        <select id="refund-filter" onchange="applyTrainingFilters()" class="p-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500" disabled>
                            <option value="All">í™˜ê¸‰ ì „ì²´</option>
                            <option value="O">í™˜ê¸‰ ì™„ë£Œ (O)</option>
                            <option value="X">í™˜ê¸‰ ë¶ˆê°€ (X)</option>
                            <option value="N/A">í•´ë‹¹ ì—†ìŒ (N/A)</option>
                        </select>
                    </div>

                    <ul id="individual-history-list" class="space-y-2 max-h-96 overflow-y-auto pr-2 border border-gray-200 rounded-lg p-2 bg-white db-scroll-area">
                        <p class="text-red-500 p-2 font-semibold">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì´ìˆ˜ ë‚´ì—­ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                    </ul>
                </div>
            </div>

            <!-- 3. ê´€ì‹¬ êµìœ¡ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ -->
            <div id="interest-list-section" class="main-content-section">
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-blue-600 min-h-[250px]">
                    <h2 class="text-2xl font-bold text-gray-700 mb-6">ì €ì¥ ëª©ë¡</h2>

                    <div class="mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <h3 class="text-xl font-bold text-blue-700 mb-3 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2 text-blue-500 fill-current" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg> ê´€ì‹¬ êµìœ¡ í‚¤ì›Œë“œ (íŒ€/ì‚¬ì—…ë¶€)
                        </h3>
                        <div id="keyword-list-container" class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                            <p class="text-center text-gray-500 col-span-full p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ í‚¤ì›Œë“œ ëª©ë¡ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                        </div>
                    </div>
                    
                    <div class="p-4 border border-blue-200 rounded-lg space-y-4 bg-gray-50">
                        <div id="team-status-display" class="p-2 border-b border-blue-200">
                            <h3 class="text-xl font-bold text-blue-700 mb-2">íŒ€ êµìœ¡ í˜„í™© (ëª©í‘œ ëŒ€ë¹„ ì§„ì²™ë„)</h3>
                            <p class="text-gray-700 p-2 font-semibold">íŒ€ êµìœ¡ í˜„í™© ë°ì´í„°ëŠ” í˜„ì¬ ë¹„í™œì„±í™”ë˜ì–´ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                            <p class="text-xs text-gray-500 mt-3">ì´ í•­ëª©ì€ ERP/íŒ€ë³„ ë°ì´í„° ì—°ë™ì´ ì™„ë£Œë˜ë©´ íŒ€ì› ì „ì²´ì˜ í‰ê·  ë‹¬ì„±ë¥ ì„ ë³´ì—¬ì¤„ ì˜ˆì •ì…ë‹ˆë‹¤.</p>
                        </div>
                        
                        <div class="pt-2">
                            <h3 class="text-xl font-bold text-indigo-700 mb-2">ë‚˜ì˜ ìŠ¤í¬ë© ëª©ë¡</h3>
                            <ul id="interest-list-container" class="space-y-3 max-h-64 overflow-y-auto pr-2 db-scroll-area">
                                <p class="text-center text-red-500 p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ëª©ë¡ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 4. êµìœ¡ ê³µìœ  ê²Œì‹œíŒ ì„¹ì…˜ -->
            <div id="sharing-board-section" class="main-content-section">
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-teal-500">
                    <h2 class="text-2xl font-bold text-gray-700 mb-4 flex items-center">
                        êµìœ¡ ê³µìœ  ê²Œì‹œíŒ (ë¹„í™œì„±í™”)
                    </h2>

                    <!-- Sharing Form -->
                    <form id="sharing-form" class="p-4 bg-teal-50 border border-teal-200 rounded-lg shadow-inner mb-6 space-y-3">
                        <h3 class="text-lg font-bold text-teal-800">ìƒˆë¡œìš´ êµìœ¡ ì •ë³´ ê³µìœ í•˜ê¸° (ë¹„í™œì„±í™”)</h3>
                        <div class="bg-red-50 border-l-4 border-red-400 text-red-700 p-3 text-sm" role="alert">
                            <p class="font-semibold">âš ï¸ ê¸°ëŠ¥ ë¹„í™œì„±í™”</p>
                            <p>ì´ ì–‘ì‹ì€ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                        </div>
                        <div>
                            <label for="title" class="block text-sm font-medium text-teal-700">ì œëª© (êµìœ¡/ìë£Œ ëª…)</label>
                            <input type="text" id="title" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-teal-500 focus:border-teal-500" disabled>
                        </div>
                        <div>
                            <label for="content" class="block text-sm font-medium text-teal-700">ë‚´ìš© (ê°„ë‹¨í•œ ì„¤ëª…/ë§í¬)</label>
                            <textarea id="content" rows="3" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-teal-500 focus:border-teal-500" disabled></textarea>
                        </div>
                        <button type="submit" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 transition duration-150 ease-in-out" disabled>
                            ì •ë³´ ê³µìœ í•˜ê¸° (ë¹„í™œì„±í™”)
                        </button>
                    </form>

                    <!-- Shared List -->
                    <div id="shared-list" class="space-y-4 max-h-96 overflow-y-auto pr-2 db-scroll-area">
                        <p class="text-center text-red-500 p-4">âš ï¸ ê²Œì‹œíŒ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. (ë°ì´í„° ë¡œì§ ì œê±°ë¨)</p>
                    </div>
                </div>
            </div>
            
            <!-- 5. ë¬¸ì˜/ì‘ì„± ì´ë ¥ ì„¹ì…˜ -->
            <div id="inquiry-section" class="main-content-section">
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-amber-500 min-h-[250px]">
                    <h2 class="text-2xl font-bold text-gray-700 mb-4">ë¬¸ì˜ / ì‘ì„± ì´ë ¥</h2>
                    <h3 class="text-lg font-semibold text-gray-600 mb-3">ê°œì¸ í™œë™ ë‚´ì—­</h3>
                    <ul id="inquiry-history-list" class="space-y-3 max-h-96 overflow-y-auto pr-2 db-scroll-area">
                        <p class="text-center text-gray-500 p-4">âš ï¸ ë°ì´í„° ë¡œì§ì´ ì œê±°ë˜ì–´ ì´ë ¥ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                    </ul>
                </div>
            </div>
        </main>
    </div>
</body>
</html>
